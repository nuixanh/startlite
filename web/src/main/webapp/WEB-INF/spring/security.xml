<beans:beans xmlns="http://www.springframework.org/schema/security"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://www.springframework.org/schema/beans
                http://www.springframework.org/schema/beans/spring-beans-3.2.xsd
                http://www.springframework.org/schema/security
                http://www.springframework.org/schema/security/spring-security-3.2.xsd">

    <http use-expressions="true">
        <intercept-url pattern="/login.html*" access="permitAll" />
        <intercept-url pattern="/**" access="isAuthenticated()" />
        <form-login
                login-page="/login.html"
                default-target-url="/add-merchant.html"
                authentication-failure-url="/login.html?login_error=1"
                always-use-default-target="true"/>
        <logout/>

    </http>

    <!--<authentication-manager>
        <authentication-provider>
            <user-service>
                <user name="rod" password="koala" authorities="supervisor, teller, user" />
                <user name="dianne" password="emu" authorities="teller, user" />
                <user name="scott" password="wombat" authorities="user" />
                <user name="peter" password="opal" authorities="user" />
            </user-service>
        </authentication-provider>
    </authentication-manager>-->
    <!--access-decision-manager-ref="accessDecisionManager"-->
    <!--<http auto-config="false" >
        <intercept-url pattern="/login.html*" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <form-login login-page="/login.html" authentication-failure-url="/login.html?error=1" login-processing-url="/j_security_check"/>
    </http>-->
    <beans:bean id="customUserDetailsService" class="com.clas.startlite.webapp.CustomUserDetailsService"/>

    <authentication-manager>
        <authentication-provider user-service-ref="customUserDetailsService"/>
    </authentication-manager>

    <!--<beans:bean id="accessDecisionManager" class="org.springframework.security.access.vote.AffirmativeBased">
        <beans:property name="allowIfAllAbstainDecisions">
            <beans:value>false</beans:value>
        </beans:property>
        <beans:property name="decisionVoters">
            <beans:list>
                <beans:ref local="roleVoter"/>
                <beans:bean class="org.springframework.security.access.vote.AuthenticatedVoter"/>
            </beans:list>
        </beans:property>
    </beans:bean>
    <beans:bean id="roleVoter" class="org.springframework.security.access.vote.RoleVoter">
        <beans:property name="rolePrefix">
            <beans:value/>
        </beans:property>
    </beans:bean>-->
</beans:beans>